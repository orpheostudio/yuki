<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<meta name="theme-color" content="#00eaff" />
<meta name="description" content="Sion v5 - Assistente inteligente de pr√≥xima gera√ß√£o" />
<link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlNpb24gdjUiLAogICJzaG9ydF9uYW1lIjogIlNpb24iLAogICJzdGFydF91cmwiOiAiLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzA4MTAxYSIsCiAgInRoZW1lX2NvbG9yIjogIiMwMGVhZmYiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWwsJTNDc3ZnJTIwd2lkdGg9JzE5MicgaGVpZ2h0PScxOTInJTIwdmlld0JveD0nMCUyMDAlMjAxOTIlMjAxOTInJTIweG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyUzRSUzQ3JlY3QlMjB3aWR0aD0nMTkyJyUyMGhlaWdodD0nMTkyJyUyMGZpbGw9JyUyMzA4MTAxYScvJTNFJTNDdGV4dCUyMHg9JzUwJTI1JyUyMHk9JzUwJTI1JyUyMGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnJTIwdGV4dC1hbmNob3I9J21pZGRsZSclMjBmb250LWZhbWlseT0nc2Fucy1zZXJpZiclMjBmb250LXNpemU9JzgwJyUyMGZpbGw9JyUyMzAwZWFmZiclM0VTJTNDL3RleHQlM0UlM0Mvc3ZnJTNFIiwKICAgICAgInNpemVzIjogIjE5MngxOTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0KfQ==" />
<title>Sion ‚Äî AmplaAI</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
  
  * { 
    box-sizing: border-box; 
    margin: 0; 
    padding: 0; 
  }
  
  :root {
    --bg-primary: #0a0e1a;
    --bg-secondary: #0f1623;
    --bg-chat: #141b2d;
    --bg-elevated: #1a2332;
    --accent: #00eaff;
    --accent-glow: rgba(0, 234, 255, 0.4);
    --accent-dark: #00b8cc;
    --accent-light: #5ffbff;
    --purple: #a855f7;
    --purple-glow: rgba(168, 85, 247, 0.3);
    --text-primary: #f0f4f8;
    --text-secondary: #94a3b8;
    --text-tertiary: #64748b;
    --border: rgba(148, 163, 184, 0.1);
    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.2);
    --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.3);
    --shadow-lg: 0 8px 40px rgba(0, 0, 0, 0.4);
    --shadow-glow: 0 0 20px var(--accent-glow);
  }
  
  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    height: 100vh;
    overflow: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  /* ========== ENHANCED PWA INSTALL PROMPT ========== */
  #installPrompt {
    position: fixed;
    bottom: 24px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(135deg, #00d4ff 0%, #a855f7 100%);
    color: #0b0e13;
    padding: 14px 24px;
    border-radius: 50px;
    box-shadow: 0 8px 32px rgba(0, 194, 255, 0.4), 0 0 0 1px rgba(255,255,255,0.1);
    display: none;
    align-items: center;
    gap: 16px;
    z-index: 10000;
    font-weight: 700;
    backdrop-filter: blur(12px);
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  #installPrompt.show {
    display: flex;
    animation: slideUpBounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), pulseGlow 3s infinite ease-in-out;
  }

  #installPrompt:hover {
    transform: translateX(-50%) translateY(-4px) scale(1.02);
    box-shadow: 0 12px 48px rgba(0, 255, 200, 0.5), 0 0 0 1px rgba(255,255,255,0.2);
  }

  .promptIcon {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    overflow: hidden;
    border: 2.5px solid rgba(255,255,255,0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 16px rgba(255,255,255,0.4);
    animation: rotateIcon 8s linear infinite;
  }

  .promptIcon img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: drop-shadow(0 0 6px #00c2ff);
  }

  #installPrompt button {
    background: rgba(255, 255, 255, 0.2);
    border: 1.5px solid rgba(255, 255, 255, 0.3);
    padding: 10px 22px;
    border-radius: 24px;
    color: #fff;
    font-weight: 700;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    backdrop-filter: blur(8px);
  }

  #installPrompt button:hover {
    background: rgba(255, 255, 255, 0.35);
    transform: scale(1.08);
    border-color: rgba(255, 255, 255, 0.5);
  }

  @keyframes slideUpBounce {
    0% {
      transform: translateX(-50%) translateY(120px);
      opacity: 0;
    }
    60% {
      transform: translateX(-50%) translateY(-8px);
      opacity: 1;
    }
    80% {
      transform: translateX(-50%) translateY(4px);
    }
    100% {
      transform: translateX(-50%) translateY(0);
    }
  }

  @keyframes pulseGlow {
    0%, 100% {
      box-shadow: 0 8px 32px rgba(0,194,255,0.4), 0 0 0 1px rgba(255,255,255,0.1);
    }
    50% {
      box-shadow: 0 12px 48px rgba(0,255,200,0.6), 0 0 0 1px rgba(255,255,255,0.2);
    }
  }

  @keyframes rotateIcon {
    0% { transform: rotate(0deg) scale(1); }
    50% { transform: rotate(180deg) scale(1.1); }
    100% { transform: rotate(360deg) scale(1); }
  }
  
  /* ========== PREMIUM LOADING SCREEN ========== */
  #loadingScreen {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle at center, #0f1623 0%, #0a0e1a 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 32px;
    z-index: 9999;
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  
  .loaderContainer {
    position: relative;
    width: 120px;
    height: 120px;
  }
  
  .loader {
    position: absolute;
    inset: 0;
    border: 4px solid transparent;
    border-top-color: var(--accent);
    border-right-color: var(--purple);
    border-radius: 50%;
    animation: spin 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
  }
  
  .loader:nth-child(2) {
    border-top-color: var(--purple);
    border-right-color: var(--accent);
    animation-duration: 1.5s;
    animation-direction: reverse;
  }
  
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  
  .loadingText {
    font-size: 1.3rem;
    font-weight: 700;
    background: linear-gradient(90deg, var(--accent), var(--purple), var(--accent));
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: 1px;
    animation: shimmer 3s linear infinite;
  }
  
  @keyframes shimmer {
    to { background-position: 200% center; }
  }
  
  @keyframes glowPulse {
    0%, 100% { 
      box-shadow: 0 0 30px var(--accent-glow); 
      transform: scale(1); 
    }
    50% { 
      box-shadow: 0 0 60px var(--accent-glow), 0 0 100px rgba(168, 85, 247, 0.3); 
      transform: scale(1.1); 
    }
  }

  #sionLogo {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid var(--accent);
    animation: glowPulse 2.5s ease-in-out infinite;
    transition: all 0.6s ease;
    position: relative;
    z-index: 1;
  }

  #sionLogo.stopped {
    animation: none;
    transform: scale(1);
    box-shadow: 0 0 20px var(--accent-glow);
  }
  
  /* ========== ENHANCED WELCOME SCREEN ========== */
  .screen {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: radial-gradient(ellipse at top, rgba(0, 234, 255, 0.05), transparent 60%),
                radial-gradient(ellipse at bottom, rgba(168, 85, 247, 0.05), transparent 60%),
                var(--bg-primary);
    color: #fff;
    text-align: center;
    overflow: hidden;
    animation: fadeIn 1s ease-in;
  }

  .welcomeContent {
    max-width: 560px;
    padding: 32px;
    animation: floatIn 1s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .welcomeLogo {
    margin-bottom: 28px;
    position: relative;
  }
  
  .welcomeLogo::before {
    content: '';
    position: absolute;
    inset: -20px;
    background: radial-gradient(circle, var(--accent-glow), transparent 70%);
    animation: pulse 3s ease-in-out infinite;
    z-index: 0;
  }

  .sionAvatarLarge {
    width: 140px;
    height: 140px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid var(--accent);
    box-shadow: 0 0 40px var(--accent-glow), 0 8px 32px rgba(0,0,0,0.3);
    animation: glow 3s ease-in-out infinite;
    position: relative;
    z-index: 1;
  }

  .welcomeTitle {
    font-size: 2.2rem;
    margin: 16px 0;
    font-weight: 800;
    background: linear-gradient(135deg, var(--accent) 0%, var(--purple) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: -0.5px;
  }

  .welcomeText {
    font-size: 1.05rem;
    color: var(--text-secondary);
    margin-bottom: 32px;
    line-height: 1.7;
    font-weight: 400;
  }

  .welcomeButtons {
    display: flex;
    justify-content: center;
    gap: 14px;
    flex-wrap: wrap;
  }

  .btn {
    padding: 14px 28px;
    border-radius: 14px;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    border: none;
    font-weight: 700;
    letter-spacing: 0.3px;
  }

  .btn-primary {
    background: linear-gradient(135deg, var(--accent) 0%, #00ffb3 100%);
    color: #0b0e13;
    box-shadow: 0 4px 20px rgba(0, 194, 255, 0.4);
  }

  .btn-primary:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 8px 32px rgba(0, 255, 179, 0.6);
  }

  .btn-secondary {
    background: rgba(255,255,255,0.08);
    color: #fff;
    border: 2px solid rgba(255,255,255,0.2);
    backdrop-filter: blur(8px);
  }

  .btn-secondary:hover {
    background: rgba(255,255,255,0.15);
    transform: translateY(-3px) scale(1.05);
    border-color: rgba(255,255,255,0.3);
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.96); }
    to { opacity: 1; transform: scale(1); }
  }

  @keyframes floatIn {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes glow {
    0%, 100% { box-shadow: 0 0 30px var(--accent-glow), 0 8px 32px rgba(0,0,0,0.3); }
    50% { box-shadow: 0 0 50px rgba(0,255,200,0.8), 0 12px 48px rgba(0,0,0,0.4); }
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.1); }
  }
  
  /* ========== ENHANCED ABOUT & TERMS SCREENS ========== */
  .contentBox {
    background: var(--bg-elevated);
    border-radius: 24px;
    padding: 32px;
    max-width: 640px;
    max-height: 70vh;
    overflow-y: auto;
    border: 1px solid var(--border);
    margin-bottom: 28px;
    box-shadow: var(--shadow-lg);
    backdrop-filter: blur(16px);
  }
  
  .contentBox h2 {
    color: var(--accent);
    margin-bottom: 20px;
    font-size: 1.8rem;
    font-weight: 800;
    display: flex;
    align-items: center;
    gap: 12px;
  }
  
  .contentBox p {
    color: var(--text-secondary);
    line-height: 1.8;
    margin-bottom: 16px;
    font-size: 1rem;
  }
  
  .contentBox strong {
    color: var(--text-primary);
    font-weight: 600;
  }
  
  .contentBox a {
    color: var(--accent);
    text-decoration: none;
    font-weight: 600;
    transition: color 0.3s;
  }
  
  .contentBox a:hover {
    color: var(--accent-light);
    text-decoration: underline;
  }
  
  .checkboxGroup {
    display: flex;
    align-items: center;
    gap: 14px;
    margin: 24px 0;
    padding: 20px;
    background: rgba(0, 234, 255, 0.06);
    border-radius: 16px;
    border: 1px solid rgba(0, 234, 255, 0.15);
  }
  
  .checkboxGroup input[type="checkbox"] {
    width: 22px;
    height: 22px;
    cursor: pointer;
    accent-color: var(--accent);
  }
  
  .checkboxGroup label {
    color: var(--text-primary);
    font-size: 1rem;
    cursor: pointer;
    font-weight: 500;
  }
  
  /* ========== PREMIUM CHAT APP ========== */
  #app {
    display: none;
    height: 100vh;
    flex-direction: column;
    background: var(--bg-primary);
  }
  
  #app.active {
    display: flex;
    animation: fadeIn 0.6s ease;
  }
  
  /* Enhanced Header */
  .chatHeader {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-elevated) 100%);
    color: #fff;
    padding: 14px 20px;
    border-bottom: 1px solid var(--border);
    box-shadow: var(--shadow-md);
    backdrop-filter: blur(16px);
  }

  .headerLeft {
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .logo {
    width: 52px;
    height: 52px;
    overflow: hidden;
    border-radius: 50%;
    border: 2.5px solid var(--accent);
    box-shadow: 0 0 20px var(--accent-glow);
    flex-shrink: 0;
    transition: all 0.3s ease;
  }
  
  .logo:hover {
    transform: scale(1.08);
    box-shadow: 0 0 32px var(--accent-glow);
  }

  .sionAvatar {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
  }

  .headerInfo h3 {
    font-size: 1.2rem;
    margin: 0;
    font-weight: 700;
    letter-spacing: -0.3px;
  }

  .headerInfo p {
    font-size: 0.88rem;
    color: var(--accent-light);
    margin: 2px 0 0;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  
  .statusDot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #00ff88;
    box-shadow: 0 0 8px #00ff88;
    animation: blink 2s ease-in-out infinite;
  }
  
  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  .headerActions {
    display: flex;
    gap: 8px;
  }
  
  .headerActions .iconBtn {
    background: rgba(0, 234, 255, 0.1);
    border: 1px solid rgba(0, 234, 255, 0.2);
    padding: 10px;
    border-radius: 12px;
    font-size: 1.4rem;
    color: var(--accent);
    cursor: pointer;
    transition: all 0.3s ease;
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .headerActions .iconBtn:hover {
    background: rgba(0, 234, 255, 0.2);
    transform: scale(1.1);
    box-shadow: 0 0 16px var(--accent-glow);
  }
  
  /* Enhanced Chat Messages */
  .chatMessages {
    flex: 1;
    overflow-y: auto;
    padding: 24px;
    background: var(--bg-primary);
    display: flex;
    flex-direction: column;
    gap: 16px;
  }
  
  .message {
    display: flex;
    gap: 12px;
    max-width: 75%;
    animation: messageSlide 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  
  @keyframes messageSlide {
    from { 
      opacity: 0; 
      transform: translateY(20px) scale(0.95); 
    }
    to { 
      opacity: 1; 
      transform: translateY(0) scale(1); 
    }
  }
  
  .message.user {
    align-self: flex-end;
    flex-direction: row-reverse;
  }
  
  .message.system {
    align-self: center;
    max-width: 90%;
  }
  
  .messageAvatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent), var(--purple));
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    font-size: 18px;
    color: #000;
    flex-shrink: 0;
    box-shadow: var(--shadow-sm);
  }
  
  .message.user .messageAvatar {
    background: linear-gradient(135deg, #667eea, #764ba2);
  }
  
  .messageBubble {
    background: var(--bg-elevated);
    padding: 14px 18px;
    border-radius: 20px;
    color: var(--text-primary);
    line-height: 1.6;
    word-wrap: break-word;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border);
    font-size: 0.98rem;
  }
  
  .message.user .messageBubble {
    background: linear-gradient(135deg, var(--accent-dark), var(--accent));
    color: #000;
    font-weight: 500;
    border: none;
    box-shadow: 0 4px 16px rgba(0, 234, 255, 0.25);
  }
  
  .message.system .messageBubble {
    background: rgba(255, 255, 255, 0.04);
    color: var(--text-secondary);
    font-size: 0.92rem;
    text-align: center;
    font-style: italic;
    border: 1px solid rgba(255,255,255,0.06);
  }
  
  .messageTime {
    font-size: 0.75rem;
    color: var(--text-tertiary);
    margin-top: 6px;
    opacity: 0.7;
  }
  
  /* Enhanced Typing Indicator */
  .typingIndicator {
    display: none;
    align-items: center;
    gap: 12px;
    padding: 12px 18px;
    background: var(--bg-elevated);
    border-radius: 16px;
    width: fit-content;
    margin: 0 24px 12px;
    box-shadow: 0 0 20px var(--accent-glow);
    border: 1px solid rgba(0, 234, 255, 0.2);
    animation: fadeIn 0.4s ease-in;
  }
  
  .typingIndicator.active {
    display: flex;
  }

  .typingIndicator .logo {
    width: 40px;
    height: 40px;
    border: 2.5px solid var(--accent);
    box-shadow: 0 0 16px var(--accent-glow);
  }

  .typingDots {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .typingDots span {
    display: block;
    width: 9px;
    height: 9px;
    background: var(--accent);
    border-radius: 50%;
    opacity: 0.6;
    animation: typing 1.4s infinite ease-in-out;
    box-shadow: 0 0 8px var(--accent-glow);
  }

  .typingDots span:nth-child(2) {
    animation-delay: 0.2s;
  }
  .typingDots span:nth-child(3) {
    animation-delay: 0.4s;
  }

  @keyframes typing {
    0%, 80%, 100% { 
      transform: translateY(0) scale(1); 
      opacity: 0.5; 
    }
    40% { 
      transform: translateY(-8px) scale(1.2); 
      opacity: 1; 
    }
  }
  
  /* Enhanced Input Area */
  .chatInput {
    background: var(--bg-elevated);
    padding: 18px 24px;
    border-top: 1px solid var(--border);
    display: flex;
    gap: 14px;
    align-items: center;
    box-shadow: 0 -4px 20px rgba(0,0,0,0.2);
  }
  
  .inputWrapper {
    flex: 1;
    position: relative;
  }
  
  #messageInput {
    width: 100%;
    padding: 14px 56px 14px 18px;
    border-radius: 28px;
    border: 2px solid var(--border);
    background: var(--bg-chat);
    color: var(--text-primary);
    font-size: 0.98rem;
    outline: none;
    transition: all 0.3s ease;
    font-family: 'Inter', sans-serif;
  }
  
  #messageInput:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 4px rgba(0, 234, 255, 0.1);
    background: var(--bg-secondary);
  }
  
  #messageInput::placeholder {
    color: var(--text-tertiary);
  }
  
  .voiceBtn {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: none;
    background: rgba(0, 234, 255, 0.1);
    color: var(--accent);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.3rem;
    transition: all 0.3s ease;
  }
  
  .voiceBtn:hover {
    background: rgba(0, 234, 255, 0.2);
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 0 16px var(--accent-glow);
  }
  
  .voiceBtn.recording {
    background: rgba(255, 68, 68, 0.2);
    color: #ff4444;
    animation: pulse 1.2s infinite;
  }
  
  @keyframes pulse {
    0%, 100% { 
      opacity: 1; 
      box-shadow: 0 0 0 0 rgba(255, 68, 68, 0.4); 
    }
    50% { 
      opacity: 0.8; 
      box-shadow: 0 0 0 10px rgba(255, 68, 68, 0); 
    }
  }
  
  #sendBtn {
    width: 54px;
    height: 54px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(135deg, var(--accent) 0%, var(--purple) 100%);
    color: #000;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.4rem;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 6px 24px rgba(0, 234, 255, 0.4);
    font-weight: 800;
  }
  
  #sendBtn:hover {
    transform: scale(1.1) rotate(15deg);
    box-shadow: 0 8px 36px rgba(0, 234, 255, 0.6);
  }
  
  #sendBtn:active {
    transform: scale(0.92);
  }
  
  /* Enhanced Menu Drawer */
  .menuDrawer {
    position: fixed;
    top: 0;
    right: -100%;
    width: 320px;
    height: 100vh;
    background: var(--bg-elevated);
    box-shadow: -8px 0 40px rgba(0, 0, 0, 0.4);
    z-index: 2000;
    transition: right 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    display: flex;
    flex-direction: column;
    border-left: 1px solid var(--border);
  }
  
  .menuDrawer.open {
    right: 0;
  }
  
  .menuHeader {
    padding: 24px;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, var(--bg-secondary), var(--bg-elevated));
  }
  
  .menuHeader h3 {
    font-size: 1.3rem;
    font-weight: 800;
    background: linear-gradient(135deg, var(--accent), var(--purple));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  
  .menuHeader .iconBtn {
    width: 36px;
    height: 36px;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border);
    color: var(--text-primary);
    font-size: 1.3rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .menuHeader .iconBtn:hover {
    background: rgba(255, 68, 68, 0.15);
    color: #ff4444;
    transform: rotate(90deg);
  }
  
  .menuList {
    flex: 1;
    overflow-y: auto;
    padding: 12px 0;
  }
  
  .menuItem {
    padding: 18px 24px;
    display: flex;
    align-items: center;
    gap: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
    border-left: 3px solid transparent;
    position: relative;
  }
  
  .menuItem:hover {
    background: rgba(0, 234, 255, 0.08);
    border-left-color: var(--accent);
  }
  
  .menuItem:hover::after {
    content: '‚Üí';
    position: absolute;
    right: 24px;
    color: var(--accent);
    font-weight: 800;
    animation: slideRight 0.6s ease infinite;
  }
  
  @keyframes slideRight {
    0%, 100% { transform: translateX(0); }
    50% { transform: translateX(6px); }
  }
  
  .menuItem span:first-child {
    font-size: 1.4rem;
    width: 32px;
    text-align: center;
  }
  
  .menuItem span:last-child {
    font-weight: 600;
    font-size: 0.98rem;
    color: var(--text-primary);
  }
  
  .menuOverlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px);
    z-index: 1999;
    display: none;
    animation: fadeIn 0.3s ease;
  }
  
  .menuOverlay.active {
    display: block;
  }
  
  /* Scrollbar Enhancement */
  ::-webkit-scrollbar {
    width: 10px;
  }
  
  ::-webkit-scrollbar-track {
    background: var(--bg-primary);
  }
  
  ::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, var(--accent-dark), var(--purple));
    border-radius: 5px;
    border: 2px solid var(--bg-primary);
  }
  
  ::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(180deg, var(--accent), var(--purple));
  }
  
  /* Responsive Design */
  @media (max-width: 768px) {
    .message {
      max-width: 88%;
    }
    
    .welcomeTitle {
      font-size: 1.8rem;
    }
    
    .contentBox {
      padding: 24px;
      max-height: 75vh;
    }
    
    .menuDrawer {
      width: 280px;
    }
    
    .chatMessages {
      padding: 16px;
    }
    
    .chatInput {
      padding: 14px 16px;
    }
  }
  
  @media (max-width: 480px) {
    .welcomeContent {
      padding: 24px;
    }
    
    .sionAvatarLarge {
      width: 110px;
      height: 110px;
    }
    
    .welcomeTitle {
      font-size: 1.6rem;
    }
    
    .btn {
      padding: 12px 22px;
      font-size: 0.95rem;
    }
  }
  
  /* Utility Classes */
  .hidden {
    display: none !important;
  }
  
  .fade-out {
    opacity: 0;
    pointer-events: none;
  }
</style>
</head>
<body>

<!-- PWA Install Prompt -->
<div id="installPrompt" class="hidden">
  <div class="promptIcon">
    <img src="https://i.imgur.com/ME0t8KG.png" alt="Sion Icon" />
  </div>
  <span>Instale o Sion no seu dispositivo</span>
  <button id="installBtn">Instalar</button>
</div>

<!-- Loading Screen -->
<div id="loadingScreen">
  <div class="loaderContainer">
    <img 
      id="sionLogo"
      src="https://i.imgur.com/ME0t8KG.png" 
      alt="Sion Logo"
    />
    <div class="loader"></div>
    <div class="loader"></div>
  </div>
  <div class="loadingText">Inicializando Sion v5...</div>
  <audio id="bootSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_0c07a8e6a3.mp3?filename=digital-startup-114463.mp3"></audio>
</div>

<!-- Welcome Screen -->
<div id="welcomeScreen" class="screen">
  <div class="welcomeContent">
    <div class="welcomeLogo">
      <img 
        src="https://i.imgur.com/ME0t8KG.png" 
        alt="Sion Logo" 
        class="sionAvatarLarge"
      />
    </div>
    <h1 class="welcomeTitle">Bem-vindo ao Sion</h1>
    <p class="welcomeText">
      Seu assistente inteligente de pr√≥xima gera√ß√£o. Converse naturalmente, use comandos de voz e explore funcionalidades avan√ßadas de IA com interface premium.
    </p>
    <div class="welcomeButtons">
      <button class="btn btn-primary" id="startBtn">üöÄ Come√ßar Agora</button>
      <button class="btn btn-secondary" id="aboutBtn">üìò Sobre o Projeto</button>
    </div>
  </div>
</div>

<!-- About Screen -->
<div id="aboutScreen" class="screen hidden">
  <div class="contentBox">
    <h2>üìò Sobre o Projeto</h2>
    <p>
      <strong>Sion</strong> √© a evolu√ß√£o premium do assistente virtual experimental desenvolvido pela <strong>AmplaAI</strong>, 
      criado por Naoto. Esta vers√£o incorpora design moderno, anima√ß√µes fluidas e intelig√™ncia artificial avan√ßada da Mistral AI para 
      proporcionar conversas naturais e assist√™ncia personalizada de alto n√≠vel.
    </p>
    <p>
      <strong>üéØ Recursos principais:</strong><br>
      ‚Ä¢ Interface premium com design fluido e moderno<br>
      ‚Ä¢ Anima√ß√µes e transi√ß√µes suaves em 60 FPS<br>
      ‚Ä¢ Reconhecimento e s√≠ntese de voz avan√ßados<br>
      ‚Ä¢ PWA completo - funciona offline ap√≥s instala√ß√£o<br>
      ‚Ä¢ Integra√ß√£o com Sena AI de √∫ltima gera√ß√£o<br>
      ‚Ä¢ Analytics inteligente com Microsoft Clarity<br>
      ‚Ä¢ Sistema de notifica√ß√µes e feedback sonoro<br>
      ‚Ä¢ Modo escuro otimizado para conforto visual
    </p>
    <p>
      <strong>‚ö° Tecnologia:</strong> HTML5, CSS3 avan√ßado, JavaScript ES6+, Web Speech API, 
      Service Workers, Mistral AI API, Microsoft Clarity Analytics, Progressive Web App.
    </p>
    <p>
      <strong>üé® Design:</strong> Interface inspirada nos melhores apps de mensagens modernos,
      com gradientes vibrantes, glassmorphism e micro-intera√ß√µes que tornam cada a√ß√£o prazerosa.
    </p>
    <p style="margin-top: 24px; padding-top: 20px; border-top: 1px solid var(--border); font-size: 0.9rem; opacity: 0.8;">
      ¬© 2025 AmplaAI / Orpheo Studio - Todos os direitos reservados<br>
      Vers√£o 5.0.0 - Orpheo Studio
    </p>
  </div>
  <div style="display: flex; gap: 12px; justify-content: center;">
    <button class="btn btn-primary" id="continueFromAbout">Continuar ‚Üí</button>
    <button class="btn btn-secondary" id="backFromAbout">‚Üê Voltar</button>
  </div>
</div>

<!-- Terms Screen -->
<div id="termsScreen" class="screen hidden">
  <div class="contentBox">
    <h2>üìã Termos e Pol√≠ticas</h2>
    <p>
      Antes de prosseguir, por favor leia e aceite nossos termos de uso e pol√≠tica de privacidade.
    </p>
    <p>
      Ao usar o Sion, voc√™ concorda com o processamento de suas mensagens pela 
      Sena AI e com a coleta de dados de uso pelo Orpheo Studio para melhorias cont√≠nuas do servi√ßo.
    </p>
    <p>
      <strong>üìÑ Documentos importantes:</strong><br>
      ‚Ä¢ <a href="https://termos.orpheostudio.com.br" target="_blank" rel="noopener">Termos de Uso</a><br>
      ‚Ä¢ <a href="https://politicas.orpheostudio.com.br" target="_blank" rel="noopener">Pol√≠tica de Privacidade</a><br>
      ‚Ä¢ <a href="https://orpheostudio.github.io/termos" target="_blank" rel="noopener">Termos de uso da SenaAI</a>
    </p>
    <p style="font-size: 0.9rem; color: var(--text-tertiary); margin-top: 16px;">
      <strong>üîí Privacidade:</strong> Suas conversas s√£o processadas de forma segura e n√£o s√£o armazenadas permanentemente. 
      Utilizamos analytics apenas para melhorar a experi√™ncia do usu√°rio.
    </p>
    <div class="checkboxGroup">
      <input type="checkbox" id="acceptTerms" />
      <label for="acceptTerms">Li e aceito os Termos de Uso e Pol√≠tica de Privacidade</label>
    </div>
  </div>
  <div style="display: flex; gap: 12px; justify-content: center;">
    <button class="btn btn-primary" id="acceptBtn" disabled>‚úì Aceitar e Continuar</button>
    <button class="btn btn-secondary" id="backFromTerms">‚Üê Voltar</button>
  </div>
</div>

<!-- Main Chat App -->
<div id="app">
  <!-- Header -->
  <header class="chatHeader">
    <div class="headerLeft">
      <div class="logo">
        <img 
          src="https://i.imgur.com/ME0t8KG.png" 
          alt="Retrato de Sion" 
          class="sionAvatar" 
        />
      </div>
      <div class="headerInfo">
        <h3>Sion</h3>
        <p><span class="statusDot"></span><span id="statusText">Online</span></p>
      </div>
    </div>
    <div class="headerActions">
      <button class="iconBtn" id="menuToggle" title="Menu">‚ò∞</button>
    </div>
  </header>
  
  <!-- Messages -->
  <div class="chatMessages" id="chatMessages"></div>
  
  <!-- Typing Indicator -->
  <div class="typingIndicator" id="typingIndicator">
    <div class="logo">
      <img 
        src="https://i.imgur.com/ME0t8KG.png" 
        alt="Sion" 
        class="sionAvatar"
      />
    </div>
    <div class="typingDots">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  
  <!-- Input -->
  <div class="chatInput">
    <div class="inputWrapper">
      <input 
        type="text" 
        id="messageInput" 
        placeholder="Digite uma mensagem..."
        autocomplete="off"
      />
      <button class="voiceBtn" id="voiceBtn" title="Usar voz">üé§</button>
    </div>
    <button id="sendBtn" title="Enviar">‚û§</button>
  </div>
</div>

<!-- Menu Drawer -->
<div class="menuOverlay" id="menuOverlay"></div>
<div class="menuDrawer" id="menuDrawer">
  <div class="menuHeader">
    <h3>Menu</h3>
    <button class="iconBtn" id="closeMenu">‚úï</button>
  </div>
  <div class="menuList">
    <div class="menuItem" data-action="about"><span>üìò</span><span>Sobre o Sion</span></div>
    <div class="menuItem" data-action="joke"><span>üòÇ</span><span>Contar uma piada</span></div>
    <div class="menuItem" data-action="time"><span>üïê</span><span>Hora e Data</span></div>
    <div class="menuItem" data-action="status"><span>üìä</span><span>Status do Sistema</span></div>
    <div class="menuItem" data-action="clear"><span>üßπ</span><span>Limpar Conversa</span></div>
    <div class="menuItem" data-action="terms"><span>üìã</span><span>Termos e Pol√≠ticas</span></div>
    <div class="menuItem" data-action="help"><span>‚ùì</span><span>Ajuda</span></div>
  </div>
</div>

<script>
// ========== CONFIG ==========
const MISTRAL_API_KEY = "NFuAj8PYUPcaf6tA1BjbyXuIeSjSA4sW";
const MISTRAL_MODEL = "mistral-small-latest";
const CLARITY_ID = "tlya8thx8r";

// ========== Microsoft Clarity ==========
if (CLARITY_ID && CLARITY_ID !== "COLOQUE_SEU_ID_CLARITY_AQUI") {
  (function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", CLARITY_ID);
}

// ========== Service Worker (PWA) ==========
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    const swCode = `
      const CACHE_NAME = 'sion-v5-cache';
      const urlsToCache = ['/'];
      
      self.addEventListener('install', (e) => {
        e.waitUntil(
          caches.open(CACHE_NAME)
            .then(cache => cache.addAll(urlsToCache))
        );
        self.skipWaiting();
      });
      
      self.addEventListener('fetch', (e) => {
        e.respondWith(
          caches.match(e.request)
            .then(response => response || fetch(e.request))
        );
      });
      
      self.addEventListener('activate', (e) => {
        e.waitUntil(
          caches.keys().then(names => {
            return Promise.all(
              names.filter(name => name !== CACHE_NAME)
                .map(name => caches.delete(name))
            );
          })
        );
      });
    `;
    const blob = new Blob([swCode], { type: 'application/javascript' });
    const swUrl = URL.createObjectURL(blob);
    navigator.serviceWorker.register(swUrl)
      .then(() => console.log('‚úÖ Service Worker registrado com sucesso'))
      .catch(err => console.warn('‚ö†Ô∏è Erro ao registrar Service Worker:', err));
  });
}

// ========== PWA Install Prompt ==========
let deferredPrompt;
const installPrompt = document.getElementById('installPrompt');
const installBtn = document.getElementById('installBtn');

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  installPrompt.classList.remove('hidden');
  installPrompt.classList.add('show');
});

installBtn.addEventListener('click', async () => {
  if (!deferredPrompt) return;
  deferredPrompt.prompt();
  const { outcome } = await deferredPrompt.userChoice;
  console.log(`üì± Install prompt: ${outcome}`);
  deferredPrompt = null;
  installPrompt.classList.remove('show');
  setTimeout(() => installPrompt.classList.add('hidden'), 400);
});
navigator.serviceWorker.getRegistration().then((reg) => {
  if (reg && reg.waiting) {
    reg.waiting.postMessage({ type: 'SKIP_WAITING' });
  }
});

// ========== DOM Elements ==========
const loadingScreen = document.getElementById('loadingScreen');
const welcomeScreen = document.getElementById('welcomeScreen');
const aboutScreen = document.getElementById('aboutScreen');
const termsScreen = document.getElementById('termsScreen');
const app = document.getElementById('app');
const chatMessages = document.getElementById('chatMessages');
const messageInput = document.getElementById('messageInput');
const sendBtn = document.getElementById('sendBtn');
const voiceBtn = document.getElementById('voiceBtn');
const typingIndicator = document.getElementById('typingIndicator');
const menuToggle = document.getElementById('menuToggle');
const menuDrawer = document.getElementById('menuDrawer');
const menuOverlay = document.getElementById('menuOverlay');
const closeMenu = document.getElementById('closeMenu');
const statusText = document.getElementById('statusText');

// ========== Audio Context ==========
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function beep(freq = 440, duration = 0.1, type = 'sine') {
  try {
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = type;
    osc.frequency.value = freq;
    gain.gain.value = 0.08;
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + duration);
  } catch (err) {
    console.warn('Audio error:', err);
  }
}

// ========== Flow Control ==========
let conversationHistory = [];
let silentMode = false;

// Loading screen
window.addEventListener("load", () => {
  const bootSound = document.getElementById("bootSound");
  const sionLogo = document.getElementById("sionLogo");
  
  bootSound.volume = 0.4;
  bootSound.play().catch(() => {
    console.warn("üîá Som bloqueado pelo navegador");
  });

  setTimeout(() => {
    sionLogo.classList.add("stopped");
    loadingScreen.style.opacity = "0";
    loadingScreen.style.transform = "scale(1.05)";
    setTimeout(() => {
      loadingScreen.remove();
    }, 600);
  }, 2500);
});

// Screen transitions
function hideScreen(screen) {
  screen.classList.add('fade-out');
  setTimeout(() => screen.classList.add('hidden'), 300);
}

function showScreen(screen) {
  screen.classList.remove('hidden', 'fade-out');
}

// Welcome -> About
document.getElementById('aboutBtn').addEventListener('click', () => {
  hideScreen(welcomeScreen);
  setTimeout(() => showScreen(aboutScreen), 300);
});

// About -> Back to Welcome
document.getElementById('backFromAbout').addEventListener('click', () => {
  hideScreen(aboutScreen);
  setTimeout(() => showScreen(welcomeScreen), 300);
});

// About -> Terms
document.getElementById('continueFromAbout').addEventListener('click', () => {
  hideScreen(aboutScreen);
  setTimeout(() => showScreen(termsScreen), 300);
});

// Welcome -> Terms (direct start)
document.getElementById('startBtn').addEventListener('click', () => {
  hideScreen(welcomeScreen);
  setTimeout(() => showScreen(termsScreen), 300);
});

// Terms -> Back
document.getElementById('backFromTerms').addEventListener('click', () => {
  hideScreen(termsScreen);
  setTimeout(() => showScreen(welcomeScreen), 300);
});

// Terms checkbox
const acceptTerms = document.getElementById('acceptTerms');
const acceptBtn = document.getElementById('acceptBtn');

acceptTerms.addEventListener('change', (e) => {
  acceptBtn.disabled = !e.target.checked;
  if (e.target.checked) {
    acceptBtn.style.opacity = '1';
    acceptBtn.style.transform = 'scale(1)';
  } else {
    acceptBtn.style.opacity = '0.5';
  }
});

// Terms -> App
acceptBtn.addEventListener('click', () => {
  hideScreen(termsScreen);
  setTimeout(() => {
    app.classList.add('active');
    initChat();
  }, 300);
});

// ========== Initialize Chat ==========
function initChat() {
  addMessage('system', 'üöÄ Sion inicializado com sucesso');
  setTimeout(() => {
    addMessage('sion', 'Ol√°! Sou o Sion, seu assistente inteligente de pr√≥xima gera√ß√£o. Como posso ajudar voc√™ hoje?');
    audioCtx.resume();
    beep(660, 0.1);
  }, 800);
  messageInput.focus();
}

// ========== Message Functions ==========
function addMessage(type, text, skipHistory = false) {
  const messageDiv = document.createElement('div');
  messageDiv.className = `message ${type}`;
  
  if (type !== 'system') {
    const avatarDiv = document.createElement('div');
    avatarDiv.className = 'messageAvatar';
    avatarDiv.textContent = type === 'user' ? 'U' : 'S';
    messageDiv.appendChild(avatarDiv);
  }
  
  const bubbleDiv = document.createElement('div');
  bubbleDiv.className = 'messageBubble';
  bubbleDiv.innerHTML = text;
  messageDiv.appendChild(bubbleDiv);
  
  chatMessages.appendChild(messageDiv);
  chatMessages.scrollTop = chatMessages.scrollHeight;
  
  if (!skipHistory && type !== 'system') {
    conversationHistory.push({ role: type === 'user' ? 'user' : 'assistant', content: text });
  }
  
  return bubbleDiv;
}

function showTyping() {
  typingIndicator.classList.add('active');
  chatMessages.scrollTop = chatMessages.scrollHeight;
}

function hideTyping() {
  typingIndicator.classList.remove('active');
}

async function typeText(element, text, speed = 15) {
  element.textContent = '';
  for (let i = 0; i < text.length; i++) {
    element.textContent += text.charAt(i);
    chatMessages.scrollTop = chatMessages.scrollHeight;
    await new Promise(resolve => setTimeout(resolve, speed));
  }
}

// ========== Send Message ==========
async function sendMessage() {
  const text = messageInput.value.trim();
  if (!text) return;
  
  await audioCtx.resume();
  beep(880, 0.06);
  
  addMessage('user', text);
  messageInput.value = '';
  
  const response = handleLocalCommand(text.toLowerCase());
  if (response) {
    showTyping();
    setTimeout(async () => {
      hideTyping();
      const bubble = addMessage('sion', '', true);
      await typeText(bubble, response);
      conversationHistory.push({ role: 'assistant', content: response });
      if (!silentMode) speak(response);
      beep(440, 0.06);
    }, 800);
    return;
  }
  
  await callMistralAI(text);
}

sendBtn.addEventListener('click', sendMessage);
messageInput.addEventListener('keypress', (e) => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
});

// ========== Local Commands ==========
function handleLocalCommand(text) {
  const now = new Date();
  const commands = {
    'menu': 'Digite um n√∫mero ou use o menu lateral (‚ò∞) para acessar as op√ß√µes dispon√≠veis.',
    'piada': 'Por que o JavaScript foi ao psic√≥logo? Porque tinha muitos "undefined" feelings e promessas n√£o cumpridas! üòÑ',
    'hora': `üïê Agora s√£o ${now.toLocaleTimeString('pt-BR')} de ${now.toLocaleDateString('pt-BR')}`,
    'data': `üìÖ Hoje √© ${now.toLocaleDateString('pt-BR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}`,
    'status': 'üìä Status: ‚úÖ Sistema operacional | üåê Conex√£o: Est√°vel | ü§ñ Modelo: Sena AI | ‚ö° Vers√£o: 5.0.0',
    'ajuda': 'üí° Comandos dispon√≠veis: piada, hora, data, status, limpar, sobre. Ou converse naturalmente comigo!',
    'limpar': null,
    'sobre': 'Sou o Sion v5, um assistente de IA experimental de pr√≥xima gera√ß√£o criado por Naoto da AmplaAI. Utilizo Sena AI para conversas inteligentes com interface premium.',
  };
  
  if (text === 'limpar') {
    clearChat();
    return null;
  }
  
  return commands[text] || null;
}

function clearChat() {
  chatMessages.innerHTML = '';
  conversationHistory = [];
  addMessage('system', 'üßπ Oba! Mais espa√ßo para conversarmos.');
  beep(330, 0.08);
}

// ========== Mistral AI Integration ==========
async function callMistralAI(userMessage) {
  if (!MISTRAL_API_KEY || MISTRAL_API_KEY.length < 20) {
    addMessage('sion', '‚ö†Ô∏è Chave da API Sena n√£o configurada corretamente. Por favor, verifique a configura√ß√£o.');
    return;
  }
  
  showTyping();
  statusText.textContent = 'Pensando...';
  
  try {
    const messages = [
      {
        role: 'system',
        content: 'Voc√™ √© Sion, um assistente virtual inteligente, amig√°vel e prestativo da AmplaAI. Responda de forma concisa, natural e em portugu√™s brasileiro. Seja √∫til, emp√°tico e tenha personalidade carism√°tica. Use emojis ocasionalmente para tornar as respostas mais envolventes.'
      },
      ...conversationHistory.slice(-12),
      {
        role: 'user',
        content: userMessage
      }
    ];
    
    const response = await fetch('https://api.mistral.ai/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${MISTRAL_API_KEY}`
      },
      body: JSON.stringify({
        model: MISTRAL_MODEL,
        messages: messages,
        temperature: 0.7,
        max_tokens: 800
      })
    });
    
    if (!response.ok) {
      throw new Error(`API Error: ${response.status} - ${response.statusText}`);
    }
    
    const data = await response.json();
    const aiResponse = data.choices[0].message.content;
    
    hideTyping();
    statusText.textContent = 'Online';
    
    const bubble = addMessage('sion', '', true);
    await typeText(bubble, aiResponse);
    
    conversationHistory.push({ role: 'assistant', content: aiResponse });
    
    if (!silentMode) speak(aiResponse);
    beep(440, 0.06);
    
  } catch (error) {
    console.error('‚ùå Mistral AI Error:', error);
    hideTyping();
    statusText.textContent = 'Online';
    addMessage('sion', '‚ö†Ô∏è Desculpe, ainda n√£o falo esse idioma, quer tentar novamente?');
    beep(220, 0.1);
  }
}

// ========== Speech Synthesis ==========
function speak(text) {
  if (!('speechSynthesis' in window)) return;
  
  speechSynthesis.cancel();
  
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'pt-BR';
  utterance.rate = 1.0;
  utterance.pitch = 1.0;
  utterance.volume = 0.8;
  
  const setVoice = () => {
    const voices = speechSynthesis.getVoices();
    const ptVoice = voices.find(v => v.lang.startsWith('pt-BR')) || 
                    voices.find(v => v.lang.startsWith('pt'));
    if (ptVoice) utterance.voice = ptVoice;
    speechSynthesis.speak(utterance);
  };
  
  if (speechSynthesis.getVoices().length > 0) {
    setVoice();
  } else {
    speechSynthesis.addEventListener('voiceschanged', setVoice, { once: true });
  }
}

// ========== Speech Recognition ==========
let recognition = null;
let isRecording = false;

if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  recognition = new SpeechRecognition();
  recognition.lang = 'pt-BR';
  recognition.continuous = false;
  recognition.interimResults = false;
  recognition.maxAlternatives = 1;
}

voiceBtn.addEventListener('click', async () => {
  if (!recognition) {
    alert('‚ö†Ô∏è Reconhecimento de voz n√£o suportado neste navegador. Tente usar Chrome, Edge ou Safari.');
    return;
  }
  
  await audioCtx.resume();
  
  if (!isRecording) {
    try {
      recognition.start();
      isRecording = true;
      voiceBtn.classList.add('recording');
      voiceBtn.textContent = '‚èπÔ∏è';
      statusText.textContent = 'Ouvindo...';
      beep(660, 0.08);
    } catch (error) {
      console.error('Speech recognition error:', error);
      isRecording = false;
      voiceBtn.classList.remove('recording');
      voiceBtn.textContent = 'üé§';
      statusText.textContent = 'Online';
    }
  } else {
    recognition.stop();
  }
});

if (recognition) {
  recognition.addEventListener('result', (event) => {
    const transcript = event.results[0][0].transcript;
    messageInput.value = transcript;
    beep(440, 0.08);
    setTimeout(() => sendMessage(), 300);
  });
  
  recognition.addEventListener('end', () => {
    isRecording = false;
    voiceBtn.classList.remove('recording');
    voiceBtn.textContent = 'üé§';
    statusText.textContent = 'Online';
  });
  
  recognition.addEventListener('error', (event) => {
    console.error('Speech recognition error:', event.error);
    isRecording = false;
    voiceBtn.classList.remove('recording');
    voiceBtn.textContent = 'üé§';
    statusText.textContent = 'Online';
    
    if (event.error === 'no-speech') {
      addMessage('system', 'üé§ Nenhuma fala detectada. Tente novamente.');
    } else if (event.error === 'not-allowed') {
      addMessage('system', '‚ö†Ô∏è Permiss√£o de microfone negada. Para que eu possa conversar com voc√™, verifique suas configura√ß√µes.');
    }
  });
}

// ========== Menu Drawer ==========
menuToggle.addEventListener('click', () => {
  menuDrawer.classList.add('open');
  menuOverlay.classList.add('active');
  beep(550, 0.05);
});

closeMenu.addEventListener('click', closeMenuDrawer);
menuOverlay.addEventListener('click', closeMenuDrawer);

function closeMenuDrawer() {
  menuDrawer.classList.remove('open');
  menuOverlay.classList.remove('active');
  beep(440, 0.05);
}

// Menu actions
document.querySelectorAll('.menuItem').forEach(item => {
  item.addEventListener('click', () => {
    const action = item.dataset.action;
    closeMenuDrawer();
    
    setTimeout(() => {
      switch(action) {
        case 'about':
          messageInput.value = 'sobre';
          sendMessage();
          break;
        case 'joke':
          messageInput.value = 'piada';
          sendMessage();
          break;
        case 'time':
          messageInput.value = 'hora';
          sendMessage();
          break;
        case 'status':
          messageInput.value = 'status';
          sendMessage();
          break;
        case 'clear':
          clearChat();
          break;
        case 'terms':
          window.open('https://termos.orpheostudio.com.br', '_blank', 'noopener,noreferrer');
          break;
        case 'help':
          messageInput.value = 'ajuda';
          sendMessage();
          break;
      }
    }, 300);
  });
});

// ========== Keyboard Shortcuts ==========
document.addEventListener('keydown', (e) => {
  // Ctrl/Cmd + K to focus input
  if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
    e.preventDefault();
    messageInput.focus();
  }
  
  // Ctrl/Cmd + L to clear chat
  if ((e.ctrlKey || e.metaKey) && e.key === 'l') {
    e.preventDefault();
    clearChat();
  }
  
  // Escape to close menu
  if (e.key === 'Escape' && menuDrawer.classList.contains('open')) {
    closeMenuDrawer();
  }
  
  // Ctrl/Cmd + M to toggle menu
  if ((e.ctrlKey || e.metaKey) && e.key === 'm') {
    e.preventDefault();
    if (menuDrawer.classList.contains('open')) {
      closeMenuDrawer();
    } else {
      menuToggle.click();
    }
  }
});

// ========== Auto-resize input ==========
messageInput.addEventListener('input', function() {
  this.style.height = 'auto';
  const maxHeight = 120;
  const newHeight = Math.min(this.scrollHeight, maxHeight);
  this.style.height = newHeight + 'px';
});

// ========== Connection Status Monitor ==========
window.addEventListener('online', () => {
  statusText.textContent = 'Online';
  addMessage('system', 'üåê Oba, voltei de novo.');
  beep(660, 0.1);
});

window.addEventListener('offline', () => {
  statusText.textContent = 'Offline';
  addMessage('system', '‚ö†Ô∏è Sem conex√£o. Trabalhando offline...');
  beep(220, 0.1);
});

// ========== Prevent accidental page refresh ==========
window.addEventListener('beforeunload', (e) => {
  if (conversationHistory.length > 0) {
    e.preventDefault();
    e.returnValue = '';
  }
});

// ========== Performance Monitoring ==========
if (window.performance && window.performance.timing) {
  window.addEventListener('load', () => {
    setTimeout(() => {
      const perfData = window.performance.timing;
      const loadTime = perfData.loadEventEnd - perfData.navigationStart;
      console.log(`‚ö° Tempo de carregamento: ${loadTime}ms`);
    }, 0);
  });
}

// ========== Enhanced Console Log ==========
console.log('%cüöÄ Sion v5 - Premium Edition', 'font-size: 20px; font-weight: bold; color: #00eaff; text-shadow: 0 0 10px #00eaff;');
console.log('%cüì± PWA: Service Worker registrado', 'color: #00ff88;');
console.log('%cüîä Audio: Web Speech API dispon√≠vel', 'color: #a855f7;');
console.log('%cü§ñ IA: Mistral AI integrada', 'color: #00eaff;');
console.log('%cüìä Analytics: Microsoft Clarity ativo', 'color: #ff8800;');
console.log('%c‚å®Ô∏è Atalhos:', 'font-weight: bold; color: #00eaff;');
console.log('  ‚Ä¢ Ctrl/Cmd + K: Focar no input');
console.log('  ‚Ä¢ Ctrl/Cmd + L: Limpar conversa');
console.log('  ‚Ä¢ Ctrl/Cmd + M: Toggle menu');
console.log('  ‚Ä¢ Escape: Fechar menu');

// ========== Initialize ==========
console.log('%c‚ú® Sistema pronto para uso!', 'font-size: 16px; font-weight: bold; color: #00ff88;');
</script>
</body>
</html>